"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[881],{3115:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"apis/stop-conversation","title":"Stop Conversation","description":"Stop an ongoing research conversation before it completes.","source":"@site/docs/apis/stop-conversation.md","sourceDirName":"apis","slug":"/apis/stop-conversation","permalink":"/docs/apis/stop-conversation","draft":false,"unlisted":false,"editUrl":"https://github.com/fay-work/fay-docs/tree/main/docs/apis/stop-conversation.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Check Status","permalink":"/docs/apis/check-status"},"next":{"title":"Get Output","permalink":"/docs/apis/get-output"}}');var r=s(4848),i=s(8453);const a={},o="Stop Conversation",c={},l=[{value:"Endpoint",id:"endpoint",level:2},{value:"Request Headers",id:"request-headers",level:2},{value:"Path Parameters",id:"path-parameters",level:2},{value:"Example Request",id:"example-request",level:3},{value:"Response",id:"response",level:2},{value:"Success Response (200 OK)",id:"success-response-200-ok",level:3},{value:"Error Responses",id:"error-responses",level:3},{value:"404 Not Found",id:"404-not-found",level:4},{value:"400 Bad Request",id:"400-bad-request",level:4},{value:"401 Unauthorized",id:"401-unauthorized",level:4},{value:"Response Fields",id:"response-fields",level:2},{value:"When to Use Stop",id:"when-to-use-stop",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Check Status Before Stopping",id:"check-status-before-stopping",level:3},{value:"Error Handling",id:"error-handling",level:3},{value:"User Cancellation Flow",id:"user-cancellation-flow",level:3},{value:"Rate Limits",id:"rate-limits",level:2},{value:"Important Notes",id:"important-notes",level:2},{value:"What Happens When You Stop",id:"what-happens-when-you-stop",level:3},{value:"Cannot Stop",id:"cannot-stop",level:3},{value:"After Stopping",id:"after-stopping",level:3},{value:"Use Cases",id:"use-cases",level:2},{value:"Timeout Management",id:"timeout-management",level:3},{value:"User-Initiated Cancellation",id:"user-initiated-cancellation",level:3},{value:"Next Steps",id:"next-steps",level:2},{value:"Related Endpoints",id:"related-endpoints",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"stop-conversation",children:"Stop Conversation"})}),"\n",(0,r.jsx)(n.p,{children:"Stop an ongoing research conversation before it completes."}),"\n",(0,r.jsx)(n.h2,{id:"endpoint",children:"Endpoint"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"POST /api/v1/conversation/{request_id}/stop\n"})}),"\n",(0,r.jsx)(n.h2,{id:"request-headers",children:"Request Headers"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Header"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Required"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Authorization"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Yes"}),(0,r.jsx)(n.td,{children:"Bearer token for authentication"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Content-Type"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Yes"}),(0,r.jsxs)(n.td,{children:["Must be ",(0,r.jsx)(n.code,{children:"application/json"})]})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"path-parameters",children:"Path Parameters"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameter"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Required"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"request_id"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Yes"}),(0,r.jsx)(n.td,{children:"The request ID returned from create conversation"})]})})]}),"\n",(0,r.jsx)(n.h3,{id:"example-request",children:"Example Request"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://api.fay.work/api/v1/conversation/e0a05c59-a5d7-44f3-8d5e-9e535e4db957/stop \\\n  -H "Authorization: Bearer YOUR_API_KEY" \\\n  -H "Content-Type: application/json"\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const requestId = 'e0a05c59-a5d7-44f3-8d5e-9e535e4db957';\nconst response = await fetch(`https://api.fay.work/api/v1/conversation/${requestId}/stop`, {\n  method: 'POST',\n  headers: {\n    'Authorization': 'Bearer YOUR_API_KEY',\n    'Content-Type': 'application/json'\n  }\n});\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import requests\n\nrequest_id = 'e0a05c59-a5d7-44f3-8d5e-9e535e4db957'\nheaders = {\n    'Authorization': 'Bearer YOUR_API_KEY',\n    'Content-Type': 'application/json'\n}\n\nresponse = requests.post(f'https://api.fay.work/api/v1/conversation/{request_id}/stop', \n                        headers=headers)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"response",children:"Response"}),"\n",(0,r.jsx)(n.h3,{id:"success-response-200-ok",children:"Success Response (200 OK)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": true,\n  "version": "1.0.24",\n  "data": {\n    "request_id": "e0a05c59-a5d7-44f3-8d5e-9e535e4db957",\n    "status": "STOPPED",\n    "message": "Conversation stopped successfully"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"error-responses",children:"Error Responses"}),"\n",(0,r.jsx)(n.h4,{id:"404-not-found",children:"404 Not Found"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": false,\n  "version": "1.0.24",\n  "error": {\n    "message": "Request not found",\n    "code": "REQUEST_NOT_FOUND"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"400-bad-request",children:"400 Bad Request"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": false,\n  "version": "1.0.24",\n  "error": {\n    "message": "Cannot stop completed conversation",\n    "code": "CONVERSATION_ALREADY_COMPLETED"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"401-unauthorized",children:"401 Unauthorized"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": false,\n  "version": "1.0.24",\n  "error": {\n    "message": "Invalid or expired API key",\n    "code": "INVALID_API_KEY"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"response-fields",children:"Response Fields"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"status"})}),(0,r.jsx)(n.td,{children:"boolean"}),(0,r.jsx)(n.td,{children:"Request success status"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"version"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"API version"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"data.request_id"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Unique identifier for the conversation request"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"data.status"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"New status (STOPPED)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"data.message"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Confirmation message"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"when-to-use-stop",children:"When to Use Stop"}),"\n",(0,r.jsx)(n.p,{children:"Use the stop endpoint when you need to:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cancel long-running research"})," that's taking too long"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Stop research"})," that's no longer needed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Save resources"})," by stopping unnecessary processing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Implement user cancellation"})," in your application"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"check-status-before-stopping",children:"Check Status Before Stopping"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"async function stopConversationIfNeeded(requestId) {\n  // First check current status\n  const statusResponse = await fetch(`https://api.fay.work/api/v1/conversation/${requestId}/status`, {\n    headers: {\n      'Authorization': 'Bearer YOUR_API_KEY'\n    }\n  });\n  \n  const statusResult = await statusResponse.json();\n  \n  if (!statusResult.status) {\n    throw new Error(statusResult.error.message);\n  }\n  \n  const currentStatus = statusResult.data.status;\n  \n  // Only stop if conversation is still running\n  if (currentStatus === 'PENDING' || currentStatus === 'PROCESSING') {\n    const stopResponse = await fetch(`https://api.fay.work/api/v1/conversation/${requestId}/stop`, {\n      method: 'POST',\n      headers: {\n        'Authorization': 'Bearer YOUR_API_KEY',\n        'Content-Type': 'application/json'\n      }\n    });\n    \n    const stopResult = await stopResponse.json();\n    \n    if (!stopResult.status) {\n      throw new Error(stopResult.error.message);\n    }\n    \n    return stopResult.data;\n  } else {\n    console.log(`Conversation already ${currentStatus.toLowerCase()}`);\n    return statusResult.data;\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const stopConversation = async (requestId) => {\n  try {\n    const response = await fetch(`https://api.fay.work/api/v1/conversation/${requestId}/stop`, {\n      method: 'POST',\n      headers: {\n        'Authorization': 'Bearer YOUR_API_KEY',\n        'Content-Type': 'application/json'\n      }\n    });\n    \n    const result = await response.json();\n    \n    if (!result.status) {\n      throw new Error(result.error.message);\n    }\n    \n    return result.data;\n  } catch (error) {\n    console.error('Failed to stop conversation:', error);\n    throw error;\n  }\n};\n"})}),"\n",(0,r.jsx)(n.h3,{id:"user-cancellation-flow",children:"User Cancellation Flow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"class ResearchManager {\n  constructor() {\n    this.activeRequests = new Map();\n  }\n  \n  async startResearch(prompt) {\n    const response = await fetch('https://api.fay.work/api/v1/conversations', {\n      method: 'POST',\n      headers: {\n        'Authorization': 'Bearer YOUR_API_KEY',\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({ prompt })\n    });\n    \n    const result = await response.json();\n    \n    if (!result.status) {\n      throw new Error(result.error.message);\n    }\n    \n    const requestId = result.data.request_id;\n    this.activeRequests.set(requestId, { prompt, startTime: Date.now() });\n    \n    return requestId;\n  }\n  \n  async cancelResearch(requestId) {\n    if (!this.activeRequests.has(requestId)) {\n      throw new Error('Request not found in active requests');\n    }\n    \n    try {\n      await stopConversation(requestId);\n      this.activeRequests.delete(requestId);\n      console.log(`Research ${requestId} cancelled successfully`);\n    } catch (error) {\n      console.error(`Failed to cancel research ${requestId}:`, error);\n      throw error;\n    }\n  }\n  \n  async cancelAllResearch() {\n    const promises = Array.from(this.activeRequests.keys()).map(requestId => \n      this.cancelResearch(requestId)\n    );\n    \n    await Promise.allSettled(promises);\n    this.activeRequests.clear();\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"rate-limits",children:"Rate Limits"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Free Tier"}),": 20 stop requests per hour"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pro Tier"}),": 200 stop requests per hour"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Enterprise"}),": Custom limits"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"important-notes",children:"Important Notes"}),"\n",(0,r.jsx)(n.h3,{id:"what-happens-when-you-stop",children:"What Happens When You Stop"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Immediate termination"})," of the research process"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"No partial results"})," are saved or returned"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Resources are freed"})," immediately"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Status changes"}),' to "STOPPED"']}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"cannot-stop",children:"Cannot Stop"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Completed conversations"})," (status: COMPLETED)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Failed conversations"})," (status: FAILED)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Already stopped conversations"})," (status: STOPPED)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"after-stopping",children:"After Stopping"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"No output"})," will be available"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cannot restart"})," the same request"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Create a new request"})," if you need the research again"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,r.jsx)(n.h3,{id:"timeout-management",children:"Timeout Management"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"async function researchWithTimeout(prompt, timeoutMs = 300000) { // 5 minutes\n  const requestId = await startResearch(prompt);\n  \n  const timeoutPromise = new Promise((_, reject) => {\n    setTimeout(() => reject(new Error('Research timeout')), timeoutMs);\n  });\n  \n  const completionPromise = pollForCompletion(requestId);\n  \n  try {\n    const result = await Promise.race([completionPromise, timeoutPromise]);\n    return result;\n  } catch (error) {\n    if (error.message === 'Research timeout') {\n      await stopConversation(requestId);\n      throw new Error('Research cancelled due to timeout');\n    }\n    throw error;\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"user-initiated-cancellation",children:"User-Initiated Cancellation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// In your UI\nconst cancelButton = document.getElementById('cancel-research');\ncancelButton.addEventListener('click', async () => {\n  try {\n    await researchManager.cancelResearch(currentRequestId);\n    showMessage('Research cancelled successfully');\n  } catch (error) {\n    showError('Failed to cancel research: ' + error.message);\n  }\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsx)(n.p,{children:"After stopping a conversation:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Clean up"})," any local references to the request"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Notify users"})," that the research was cancelled"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Create a new request"})," if needed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Update UI"})," to reflect the stopped state"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"related-endpoints",children:"Related Endpoints"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/apis/create-conversation",children:"Create Conversation"})," - Start a new research request"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/apis/check-status",children:"Check Status"})," - Monitor research progress"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/apis/get-output",children:"Get Output"})," - Retrieve research results"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var t=s(6540);const r={},i=t.createContext(r);function a(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);